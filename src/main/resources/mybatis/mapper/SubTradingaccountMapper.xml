<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bohai.subAccount.dao.SubTradingaccountMapper" >
  <resultMap id="BaseResultMap" type="com.bohai.subAccount.entity.SubTradingaccount" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 09 17:23:29 CST 2017.
    -->
    <result column="ACCOUNTID" property="accountid" jdbcType="VARCHAR" />
    <result column="PREMORTGAGE" property="premortgage" jdbcType="DECIMAL" />
    <result column="PRECREDIT" property="precredit" jdbcType="DECIMAL" />
    <result column="PREDEPOSIT" property="predeposit" jdbcType="DECIMAL" />
    <result column="PREBALANCE" property="prebalance" jdbcType="DECIMAL" />
    <result column="PREMARGIN" property="premargin" jdbcType="DECIMAL" />
    <result column="INTERESTBASE" property="interestbase" jdbcType="DECIMAL" />
    <result column="INTEREST" property="interest" jdbcType="DECIMAL" />
    <result column="DEPOSIT" property="deposit" jdbcType="DECIMAL" />
    <result column="WITHDRAW" property="withdraw" jdbcType="DECIMAL" />
    <result column="FROZENMARGIN" property="frozenmargin" jdbcType="DECIMAL" />
    <result column="FROZENCASH" property="frozencash" jdbcType="DECIMAL" />
    <result column="FROZENCOMMISSION" property="frozencommission" jdbcType="DECIMAL" />
    <result column="CURRMARGIN" property="currmargin" jdbcType="DECIMAL" />
    <result column="CASHIN" property="cashin" jdbcType="DECIMAL" />
    <result column="COMMISSION" property="commission" jdbcType="DECIMAL" />
    <result column="CLOSEPROFIT" property="closeprofit" jdbcType="DECIMAL" />
    <result column="POSITIONPROFIT" property="positionprofit" jdbcType="DECIMAL" />
    <result column="BALANCE" property="balance" jdbcType="DECIMAL" />
    <result column="AVAILABLE" property="available" jdbcType="DECIMAL" />
    <result column="WITHDRAWQUOTA" property="withdrawquota" jdbcType="DECIMAL" />
    <result column="RESERVE" property="reserve" jdbcType="DECIMAL" />
    <result column="TRADINGDAY" property="tradingday" jdbcType="VARCHAR" />
    <result column="SETTLEMENTID" property="settlementid" jdbcType="DECIMAL" />
    <result column="CREDIT" property="credit" jdbcType="DECIMAL" />
    <result column="MORTGAGE" property="mortgage" jdbcType="DECIMAL" />
    <result column="EXCHANGEMARGIN" property="exchangemargin" jdbcType="DECIMAL" />
    <result column="DELIVERYMARGIN" property="deliverymargin" jdbcType="DECIMAL" />
    <result column="EXCHANGEDELIVERYMARGIN" property="exchangedeliverymargin" jdbcType="DECIMAL" />
  </resultMap>
  <insert id="insert" parameterType="com.bohai.subAccount.entity.SubTradingaccount" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 09 17:23:29 CST 2017.
    -->
    insert into T_SUB_TRADINGACCOUNT (ACCOUNTID, PREMORTGAGE, PRECREDIT, 
      PREDEPOSIT, PREBALANCE, PREMARGIN, 
      INTERESTBASE, INTEREST, DEPOSIT, 
      WITHDRAW, FROZENMARGIN, FROZENCASH, 
      FROZENCOMMISSION, CURRMARGIN, CASHIN, 
      COMMISSION, CLOSEPROFIT, POSITIONPROFIT, 
      BALANCE, AVAILABLE, WITHDRAWQUOTA, 
      RESERVE, TRADINGDAY, SETTLEMENTID, 
      CREDIT, MORTGAGE, EXCHANGEMARGIN, 
      DELIVERYMARGIN, EXCHANGEDELIVERYMARGIN)
    values (#{accountid,jdbcType=VARCHAR}, #{premortgage,jdbcType=DECIMAL}, #{precredit,jdbcType=DECIMAL}, 
      #{predeposit,jdbcType=DECIMAL}, #{prebalance,jdbcType=DECIMAL}, #{premargin,jdbcType=DECIMAL}, 
      #{interestbase,jdbcType=DECIMAL}, #{interest,jdbcType=DECIMAL}, #{deposit,jdbcType=DECIMAL}, 
      #{withdraw,jdbcType=DECIMAL}, #{frozenmargin,jdbcType=DECIMAL}, #{frozencash,jdbcType=DECIMAL}, 
      #{frozencommission,jdbcType=DECIMAL}, #{currmargin,jdbcType=DECIMAL}, #{cashin,jdbcType=DECIMAL}, 
      #{commission,jdbcType=DECIMAL}, #{closeprofit,jdbcType=DECIMAL}, #{positionprofit,jdbcType=DECIMAL}, 
      #{balance,jdbcType=DECIMAL}, #{available,jdbcType=DECIMAL}, #{withdrawquota,jdbcType=DECIMAL}, 
      #{reserve,jdbcType=DECIMAL}, #{tradingday,jdbcType=VARCHAR}, #{settlementid,jdbcType=DECIMAL}, 
      #{credit,jdbcType=DECIMAL}, #{mortgage,jdbcType=DECIMAL}, #{exchangemargin,jdbcType=DECIMAL}, 
      #{deliverymargin,jdbcType=DECIMAL}, #{exchangedeliverymargin,jdbcType=DECIMAL})
  </insert>
  <insert id="insertSelective" parameterType="com.bohai.subAccount.entity.SubTradingaccount" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Feb 09 17:23:29 CST 2017.
    -->
    insert into T_SUB_TRADINGACCOUNT
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="accountid != null" >
        ACCOUNTID,
      </if>
      <if test="premortgage != null" >
        PREMORTGAGE,
      </if>
      <if test="precredit != null" >
        PRECREDIT,
      </if>
      <if test="predeposit != null" >
        PREDEPOSIT,
      </if>
      <if test="prebalance != null" >
        PREBALANCE,
      </if>
      <if test="premargin != null" >
        PREMARGIN,
      </if>
      <if test="interestbase != null" >
        INTERESTBASE,
      </if>
      <if test="interest != null" >
        INTEREST,
      </if>
      <if test="deposit != null" >
        DEPOSIT,
      </if>
      <if test="withdraw != null" >
        WITHDRAW,
      </if>
      <if test="frozenmargin != null" >
        FROZENMARGIN,
      </if>
      <if test="frozencash != null" >
        FROZENCASH,
      </if>
      <if test="frozencommission != null" >
        FROZENCOMMISSION,
      </if>
      <if test="currmargin != null" >
        CURRMARGIN,
      </if>
      <if test="cashin != null" >
        CASHIN,
      </if>
      <if test="commission != null" >
        COMMISSION,
      </if>
      <if test="closeprofit != null" >
        CLOSEPROFIT,
      </if>
      <if test="positionprofit != null" >
        POSITIONPROFIT,
      </if>
      <if test="balance != null" >
        BALANCE,
      </if>
      <if test="available != null" >
        AVAILABLE,
      </if>
      <if test="withdrawquota != null" >
        WITHDRAWQUOTA,
      </if>
      <if test="reserve != null" >
        RESERVE,
      </if>
      <if test="tradingday != null" >
        TRADINGDAY,
      </if>
      <if test="settlementid != null" >
        SETTLEMENTID,
      </if>
      <if test="credit != null" >
        CREDIT,
      </if>
      <if test="mortgage != null" >
        MORTGAGE,
      </if>
      <if test="exchangemargin != null" >
        EXCHANGEMARGIN,
      </if>
      <if test="deliverymargin != null" >
        DELIVERYMARGIN,
      </if>
      <if test="exchangedeliverymargin != null" >
        EXCHANGEDELIVERYMARGIN,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="accountid != null" >
        #{accountid,jdbcType=VARCHAR},
      </if>
      <if test="premortgage != null" >
        #{premortgage,jdbcType=DECIMAL},
      </if>
      <if test="precredit != null" >
        #{precredit,jdbcType=DECIMAL},
      </if>
      <if test="predeposit != null" >
        #{predeposit,jdbcType=DECIMAL},
      </if>
      <if test="prebalance != null" >
        #{prebalance,jdbcType=DECIMAL},
      </if>
      <if test="premargin != null" >
        #{premargin,jdbcType=DECIMAL},
      </if>
      <if test="interestbase != null" >
        #{interestbase,jdbcType=DECIMAL},
      </if>
      <if test="interest != null" >
        #{interest,jdbcType=DECIMAL},
      </if>
      <if test="deposit != null" >
        #{deposit,jdbcType=DECIMAL},
      </if>
      <if test="withdraw != null" >
        #{withdraw,jdbcType=DECIMAL},
      </if>
      <if test="frozenmargin != null" >
        #{frozenmargin,jdbcType=DECIMAL},
      </if>
      <if test="frozencash != null" >
        #{frozencash,jdbcType=DECIMAL},
      </if>
      <if test="frozencommission != null" >
        #{frozencommission,jdbcType=DECIMAL},
      </if>
      <if test="currmargin != null" >
        #{currmargin,jdbcType=DECIMAL},
      </if>
      <if test="cashin != null" >
        #{cashin,jdbcType=DECIMAL},
      </if>
      <if test="commission != null" >
        #{commission,jdbcType=DECIMAL},
      </if>
      <if test="closeprofit != null" >
        #{closeprofit,jdbcType=DECIMAL},
      </if>
      <if test="positionprofit != null" >
        #{positionprofit,jdbcType=DECIMAL},
      </if>
      <if test="balance != null" >
        #{balance,jdbcType=DECIMAL},
      </if>
      <if test="available != null" >
        #{available,jdbcType=DECIMAL},
      </if>
      <if test="withdrawquota != null" >
        #{withdrawquota,jdbcType=DECIMAL},
      </if>
      <if test="reserve != null" >
        #{reserve,jdbcType=DECIMAL},
      </if>
      <if test="tradingday != null" >
        #{tradingday,jdbcType=VARCHAR},
      </if>
      <if test="settlementid != null" >
        #{settlementid,jdbcType=DECIMAL},
      </if>
      <if test="credit != null" >
        #{credit,jdbcType=DECIMAL},
      </if>
      <if test="mortgage != null" >
        #{mortgage,jdbcType=DECIMAL},
      </if>
      <if test="exchangemargin != null" >
        #{exchangemargin,jdbcType=DECIMAL},
      </if>
      <if test="deliverymargin != null" >
        #{deliverymargin,jdbcType=DECIMAL},
      </if>
      <if test="exchangedeliverymargin != null" >
        #{exchangedeliverymargin,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <select id="getUserByUserName10" resultType="com.bohai.subAccount.vo.UserAccountVO" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    select 
    a.ACCOUNTID
	,a.PREMORTGAGE
	,a.PRECREDIT
	,a.PREDEPOSIT
	,a.PREBALANCE
	,a.PREMARGIN
	,a.INTERESTBASE
	,a.INTEREST
	,a.DEPOSIT
	,a.WITHDRAW
	,a.FROZENMARGIN
	,a.FROZENCASH
	,a.FROZENCOMMISSION
	,a.CURRMARGIN
	,a.CASHIN
	,a.COMMISSION
	,a.CLOSEPROFIT
	,a.POSITIONPROFIT
	,a.BALANCE
	,a.AVAILABLE
	,a.WITHDRAWQUOTA
	,a.RESERVE
	,a.TRADINGDAY
	,a.SETTLEMENTID
	,a.CREDIT
	,a.MORTGAGE
	,a.EXCHANGEMARGIN
	,a.DELIVERYMARGIN
	,a.EXCHANGEDELIVERYMARGIN
	,b.USER_CAPITAL_RATE
	,b.USER_CAPITAL
	,b.HOST_CAPITAL1
	,b.UPDATE_TIME
	,b.HOST_CAPITAL2
	,b.HOST_CAPITAL_RATE
	,b.USER_OUT_CAPITAL_RETAIN
	,b.USER_CAPITAL_YESTORDAY
    from T_SUB_TRADINGACCOUNT a ,T_CAPITAL_RATE b
    where a.ACCOUNTID = #{0,jdbcType=VARCHAR}
    and a.ACCOUNTID = b.USER_NAME
  </select>
  
  <update id="setFrozen" parameterType="java.util.Map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    update T_SUB_TRADINGACCOUNT set FROZENMARGIN = NVL(FROZENMARGIN,0) + #{heyuebaozhengjin,jdbcType=DECIMAL}
    ,FROZENCOMMISSION = NVL(FROZENCOMMISSION,0) + #{shouxufeikaicang,jdbcType=DECIMAL}
    <!-- ,AVAILABLE = AVAILABLE - #{heyuebaozhengjin,jdbcType=DECIMAL} - #{shouxufeikaicang,jdbcType=DECIMAL} -->
    where ACCOUNTID = #{subAccount,jdbcType=VARCHAR}
  </update>
  
  <select id="getUserByAllForAccount" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    select 
    *
    from T_SUB_TRADINGACCOUNT
  </select>
  
  <update id="updateUnfrozen" parameterType="java.util.Map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    update T_SUB_TRADINGACCOUNT set FROZENMARGIN = NVL(FROZENMARGIN,0) - nvl(#{frozenmargin,jdbcType=DECIMAL},0)
    ,FROZENCOMMISSION = NVL(FROZENCOMMISSION,0) - nvl(#{frozencommission,jdbcType=DECIMAL},0)
    <!-- ,AVAILABLE = AVAILABLE + #{frozenmargin,jdbcType=DECIMAL} + #{frozencommission,jdbcType=DECIMAL} -->
    where ACCOUNTID = #{subAccount,jdbcType=VARCHAR}
  </update>
  
  <update id="setCommission" parameterType="java.util.Map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    update T_SUB_TRADINGACCOUNT set COMMISSION = nvl(COMMISSION,0) + #{commission,jdbcType=DECIMAL}
    where ACCOUNTID = #{subAccount,jdbcType=VARCHAR}
  </update>
  
  <delete id="delete" parameterType="java.lang.String">
    delete from T_SUB_TRADINGACCOUNT
    where ACCOUNTID = #{0,jdbcType=VARCHAR}
  </delete>
  
  <update id="init">
    update T_SUB_TRADINGACCOUNT t 
	set t.AVAILABLE = (select t1.CAPITAL from t_user_info t1 where t.ACCOUNTID = t1.USER_NAME),
	t.PREMORTGAGE = 0,
	t.PRECREDIT = 0,
	t.PREDEPOSIT = 0,
	t.PREBALANCE = 0,
	t.PREMARGIN = 0,
	t.INTERESTBASE = 0,
	t.INTEREST = 0,
	t.DEPOSIT = 0,
	t.WITHDRAW = 0,
	t.FROZENMARGIN =0,
	t.FROZENCASH = 0,
	t.FROZENCOMMISSION = 0,
	t.CURRMARGIN = 0,
	t.CASHIN = 0,
	t.COMMISSION = 0,
	t.CLOSEPROFIT = 0,
	t.POSITIONPROFIT = 0,
	t.BALANCE = 0,
	t.WITHDRAWQUOTA = 0,
	t.RESERVE = 0,
	t.CREDIT = 0,
	t.MORTGAGE = 0,
	t.EXCHANGEMARGIN = 0,
	t.DELIVERYMARGIN = 0,
	t.EXCHANGEDELIVERYMARGIN = 0
  </update>
</mapper>