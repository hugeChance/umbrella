<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.bohai.subAccount.dao.InvestorPositionMapper" >
  <resultMap id="BaseResultMap" type="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 20 16:25:22 CST 2017.
    -->
    <result column="INSTRUMENTID" property="instrumentid" jdbcType="VARCHAR" />
    <result column="BROKERID" property="brokerid" jdbcType="VARCHAR" />
    <result column="INVESTORID" property="investorid" jdbcType="VARCHAR" />
    <result column="POSIDIRECTION" property="posidirection" jdbcType="VARCHAR" />
    <result column="HEDGEFLAG" property="hedgeflag" jdbcType="VARCHAR" />
    <result column="POSITIONDATE" property="positiondate" jdbcType="VARCHAR" />
    <result column="YDPOSITION" property="ydposition" jdbcType="DECIMAL" />
    <result column="POSITION" property="position" jdbcType="DECIMAL" />
    <result column="LONGFROZEN" property="longfrozen" jdbcType="DECIMAL" />
    <result column="SHORTFROZEN" property="shortfrozen" jdbcType="DECIMAL" />
    <result column="LONGFROZENAMOUNT" property="longfrozenamount" jdbcType="DECIMAL" />
    <result column="SHORTFROZENAMOUNT" property="shortfrozenamount" jdbcType="DECIMAL" />
    <result column="OPENVOLUME" property="openvolume" jdbcType="DECIMAL" />
    <result column="CLOSEVOLUME" property="closevolume" jdbcType="DECIMAL" />
    <result column="OPENAMOUNT" property="openamount" jdbcType="DECIMAL" />
    <result column="CLOSEAMOUNT" property="closeamount" jdbcType="DECIMAL" />
    <result column="POSITIONCOST" property="positioncost" jdbcType="DECIMAL" />
    <result column="PREMARGIN" property="premargin" jdbcType="DECIMAL" />
    <result column="USEMARGIN" property="usemargin" jdbcType="DECIMAL" />
    <result column="FROZENMARGIN" property="frozenmargin" jdbcType="DECIMAL" />
    <result column="FROZENCASH" property="frozencash" jdbcType="DECIMAL" />
    <result column="FROZENCOMMISSION" property="frozencommission" jdbcType="DECIMAL" />
    <result column="CASHIN" property="cashin" jdbcType="DECIMAL" />
    <result column="COMMISSION" property="commission" jdbcType="DECIMAL" />
    <result column="CLOSEPROFIT" property="closeprofit" jdbcType="DECIMAL" />
    <result column="POSITIONPROFIT" property="positionprofit" jdbcType="DECIMAL" />
    <result column="PRESETTLEMENTPRICE" property="presettlementprice" jdbcType="DECIMAL" />
    <result column="SETTLEMENTPRICE" property="settlementprice" jdbcType="DECIMAL" />
    <result column="TRADINGDAY" property="tradingday" jdbcType="VARCHAR" />
    <result column="SETTLEMENTID" property="settlementid" jdbcType="DECIMAL" />
    <result column="OPENCOST" property="opencost" jdbcType="DECIMAL" />
    <result column="EXCHANGEMARGIN" property="exchangemargin" jdbcType="DECIMAL" />
    <result column="COMBPOSITION" property="combposition" jdbcType="DECIMAL" />
    <result column="COMBLONGFROZEN" property="comblongfrozen" jdbcType="DECIMAL" />
    <result column="COMBSHORTFROZEN" property="combshortfrozen" jdbcType="DECIMAL" />
    <result column="CLOSEPROFITBYDATE" property="closeprofitbydate" jdbcType="DECIMAL" />
    <result column="CLOSEPROFITBYTRADE" property="closeprofitbytrade" jdbcType="DECIMAL" />
    <result column="TODAYPOSITION" property="todayposition" jdbcType="DECIMAL" />
    <result column="MARGINRATEBYMONEY" property="marginratebymoney" jdbcType="DECIMAL" />
    <result column="MARGINRATEBYVOLUME" property="marginratebyvolume" jdbcType="DECIMAL" />
    <result column="SUBUSERID" property="subuserid" jdbcType="VARCHAR" />
    <result column="FRONTID" property="frontid" jdbcType="DECIMAL" />
    <result column="SESSIONID" property="sessionid" jdbcType="DECIMAL" />
    <result column="ORDERREF" property="orderref" jdbcType="VARCHAR" />
    <result column="OPENTIME" property="opentime" jdbcType="VARCHAR" />
    <result column="CLOSETIME" property="closetime" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="BaseResultMap2" type="com.bohai.subAccount.entity.InvestorPosition2" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 20 16:25:22 CST 2017.
    -->
    <result column="INSTRUMENTID" property="instrumentid" jdbcType="VARCHAR" />
    <result column="TRADINGVOLUME" property="tradingvolume" jdbcType="DECIMAL" />
    <result column="AVERAGEPOSITION" property="averageposition" jdbcType="DECIMAL" />
    <result column="PRIMECOST" property="primecost" jdbcType="DECIMAL" />
    <result column="POSITION" property="position" jdbcType="DECIMAL" />
    <result column="ADJUSTABLEQUANTITY" property="adjustablequantity" jdbcType="DECIMAL" />
    <result column="POSIDIRECTION" property="posidirection" jdbcType="VARCHAR" />
    <result column="OPENAMOUNT" property="openamount" jdbcType="DECIMAL" />
    <result column="CLOSEAMOUNT" property="closeamount" jdbcType="DECIMAL" />
    <result column="CLOSEVOLUME" property="closevolume" jdbcType="DECIMAL" />
    <result column="POSITIONPROFIT" property="positionprofit" jdbcType="DECIMAL" />
    <result column="CLOSEPROFIT" property="closeprofit" jdbcType="DECIMAL" />
    <result column="USEMARGIN" property="usemargin" jdbcType="DECIMAL" />
    <result column="COMMISSION" property="commission" jdbcType="DECIMAL" />
  </resultMap>
  
  
  <select id="getUserUnClosePostion" resultMap="BaseResultMap" parameterType="java.lang.String">
    SELECT t.INSTRUMENTID, t.BROKERID, t.INVESTORID, 
      t.POSIDIRECTION, t.HEDGEFLAG, t.POSITIONDATE, 
      nvl(y.POSITION,0) as YDPOSITION, t.POSITION, t.LONGFROZEN, 
      t.SHORTFROZEN, t.LONGFROZENAMOUNT, t.SHORTFROZENAMOUNT, 
      t.OPENVOLUME, t.CLOSEVOLUME, t.OPENAMOUNT, 
      t.CLOSEAMOUNT, t.POSITIONCOST, t.PREMARGIN, 
      t.USEMARGIN, t.FROZENMARGIN, t.FROZENCASH, 
      t.FROZENCOMMISSION, t.CASHIN, t.COMMISSION, 
      t.CLOSEPROFIT, t.POSITIONPROFIT, t.PRESETTLEMENTPRICE, 
      t.SETTLEMENTPRICE, t.TRADINGDAY, t.SETTLEMENTID, 
      t.OPENCOST, t.EXCHANGEMARGIN, t.COMBPOSITION, 
      t.COMBLONGFROZEN, t.COMBSHORTFROZEN, t.CLOSEPROFITBYDATE, 
      t.CLOSEPROFITBYTRADE, t.TODAYPOSITION, t.MARGINRATEBYMONEY, 
      t.MARGINRATEBYVOLUME, t.SUBUSERID, t.FRONTID, 
      t.SESSIONID, t.ORDERREF
    FROM T_INVESTOR_POSITION t
    left join T_INVESTOR_OLD_POSITION y
    on t.SUBUSERID = y.SUBUSERID
    and t.INSTRUMENTID = y.INSTRUMENTID
    and t.POSIDIRECTION = y.POSIDIRECTION
    WHERE t.SUBUSERID = #{subuserid,jdbcType=VARCHAR}
    and t.POSITION > 0
  </select>
  
  <select id="getUserByUserName" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    SELECT INSTRUMENTID, BROKERID, INVESTORID, 
      POSIDIRECTION, HEDGEFLAG, POSITIONDATE, 
      YDPOSITION, POSITION, LONGFROZEN, 
      SHORTFROZEN, LONGFROZENAMOUNT, SHORTFROZENAMOUNT, 
      OPENVOLUME, CLOSEVOLUME, OPENAMOUNT, 
      CLOSEAMOUNT, POSITIONCOST, PREMARGIN, 
      USEMARGIN, FROZENMARGIN, FROZENCASH, 
      FROZENCOMMISSION, CASHIN, COMMISSION, 
      CLOSEPROFIT, POSITIONPROFIT, PRESETTLEMENTPRICE, 
      SETTLEMENTPRICE, TRADINGDAY, SETTLEMENTID, 
      OPENCOST, EXCHANGEMARGIN, COMBPOSITION, 
      COMBLONGFROZEN, COMBSHORTFROZEN, CLOSEPROFITBYDATE, 
      CLOSEPROFITBYTRADE, TODAYPOSITION, MARGINRATEBYMONEY, 
      MARGINRATEBYVOLUME, SUBUSERID, FRONTID, 
      SESSIONID, ORDERREF
    FROM T_INVESTOR_POSITION
    WHERE SUBUSERID = #{subuserid,jdbcType=VARCHAR}
  </select>
  
  <select id="getUserByUserName2" resultMap="BaseResultMap2" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    SELECT INSTRUMENTID, SUM(OPENVOLUME) as tradingvolume,  sum(OPENAMOUNT) as averageposition,
    sum(OPENVOLUME-CLOSEVOLUME) as adjustablequantity, posidirection, sum(openamount) as openamount,
    sum(closeamount) as closeamount, sum(closevolume) as closevolume, sum(position) as position,
    sum(commission) as commission
    FROM T_INVESTOR_POSITION
    WHERE SUBUSERID = #{subuserid,jdbcType=VARCHAR}
          AND OPENVOLUME - CLOSEVOLUME > 0
    group by INSTRUMENTID,POSIDIRECTION      
  </select>
  
  <select id="getUserByUserName3" resultMap="BaseResultMap2" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    SELECT INSTRUMENTID, SUM(OPENVOLUME) as tradingvolume, sum(OPENAMOUNT) as averageposition,
    sum(OPENVOLUME-CLOSEVOLUME) as adjustablequantity, posidirection, sum(openamount) as openamount,
    sum(closeamount) as closeamount, sum(closevolume) as closevolume, sum(position) as position,
    sum(commission) as commission
    FROM T_INVESTOR_POSITION
    WHERE SUBUSERID = #{subuserid,jdbcType=VARCHAR}
          AND OPENVOLUME - CLOSEVOLUME = 0
    group by INSTRUMENTID,POSIDIRECTION      
  </select>
  <insert id="insert" parameterType="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 20 16:25:22 CST 2017.
    -->
    insert into T_INVESTOR_POSITION (INSTRUMENTID, BROKERID, INVESTORID, 
      POSIDIRECTION, HEDGEFLAG, POSITIONDATE, 
      YDPOSITION, POSITION, LONGFROZEN, 
      SHORTFROZEN, LONGFROZENAMOUNT, SHORTFROZENAMOUNT, 
      OPENVOLUME, CLOSEVOLUME, OPENAMOUNT, 
      CLOSEAMOUNT, POSITIONCOST, PREMARGIN, 
      USEMARGIN, FROZENMARGIN, FROZENCASH, 
      FROZENCOMMISSION, CASHIN, COMMISSION, 
      CLOSEPROFIT, POSITIONPROFIT, PRESETTLEMENTPRICE, 
      SETTLEMENTPRICE, TRADINGDAY, SETTLEMENTID, 
      OPENCOST, EXCHANGEMARGIN, COMBPOSITION, 
      COMBLONGFROZEN, COMBSHORTFROZEN, CLOSEPROFITBYDATE, 
      CLOSEPROFITBYTRADE, TODAYPOSITION, MARGINRATEBYMONEY, 
      MARGINRATEBYVOLUME, SUBUSERID, FRONTID, 
      SESSIONID, ORDERREF, OPENTIME)
    values (#{instrumentid,jdbcType=VARCHAR}, #{brokerid,jdbcType=VARCHAR}, #{investorid,jdbcType=VARCHAR}, 
      #{posidirection,jdbcType=VARCHAR}, #{hedgeflag,jdbcType=VARCHAR}, #{positiondate,jdbcType=VARCHAR}, 
      #{ydposition,jdbcType=DECIMAL}, #{position,jdbcType=DECIMAL}, #{longfrozen,jdbcType=DECIMAL}, 
      #{shortfrozen,jdbcType=DECIMAL}, #{longfrozenamount,jdbcType=DECIMAL}, #{shortfrozenamount,jdbcType=DECIMAL}, 
      #{openvolume,jdbcType=DECIMAL}, #{closevolume,jdbcType=DECIMAL}, #{openamount,jdbcType=DECIMAL}, 
      #{closeamount,jdbcType=DECIMAL}, #{positioncost,jdbcType=DECIMAL}, #{premargin,jdbcType=DECIMAL}, 
      #{usemargin,jdbcType=DECIMAL}, #{frozenmargin,jdbcType=DECIMAL}, #{frozencash,jdbcType=DECIMAL}, 
      #{frozencommission,jdbcType=DECIMAL}, #{cashin,jdbcType=DECIMAL}, #{commission,jdbcType=DECIMAL}, 
      #{closeprofit,jdbcType=DECIMAL}, #{positionprofit,jdbcType=DECIMAL}, #{presettlementprice,jdbcType=DECIMAL}, 
      #{settlementprice,jdbcType=DECIMAL}, #{tradingday,jdbcType=VARCHAR}, #{settlementid,jdbcType=DECIMAL}, 
      #{opencost,jdbcType=DECIMAL}, #{exchangemargin,jdbcType=DECIMAL}, #{combposition,jdbcType=DECIMAL}, 
      #{comblongfrozen,jdbcType=DECIMAL}, #{combshortfrozen,jdbcType=DECIMAL}, #{closeprofitbydate,jdbcType=DECIMAL}, 
      #{closeprofitbytrade,jdbcType=DECIMAL}, #{todayposition,jdbcType=DECIMAL}, #{marginratebymoney,jdbcType=DECIMAL}, 
      #{marginratebyvolume,jdbcType=DECIMAL}, #{subuserid,jdbcType=VARCHAR}, #{frontid,jdbcType=DECIMAL}, 
      #{sessionid,jdbcType=DECIMAL}, #{orderref,jdbcType=VARCHAR} ,to_char(sysdate,'yyyymmddhh24miss'))
  </insert>
  <insert id="insertSelective" parameterType="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 20 16:25:22 CST 2017.
    -->
    insert into T_INVESTOR_POSITION
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="instrumentid != null" >
        INSTRUMENTID,
      </if>
      <if test="brokerid != null" >
        BROKERID,
      </if>
      <if test="investorid != null" >
        INVESTORID,
      </if>
      <if test="posidirection != null" >
        POSIDIRECTION,
      </if>
      <if test="hedgeflag != null" >
        HEDGEFLAG,
      </if>
      <if test="positiondate != null" >
        POSITIONDATE,
      </if>
      <if test="ydposition != null" >
        YDPOSITION,
      </if>
      <if test="position != null" >
        POSITION,
      </if>
      <if test="longfrozen != null" >
        LONGFROZEN,
      </if>
      <if test="shortfrozen != null" >
        SHORTFROZEN,
      </if>
      <if test="longfrozenamount != null" >
        LONGFROZENAMOUNT,
      </if>
      <if test="shortfrozenamount != null" >
        SHORTFROZENAMOUNT,
      </if>
      <if test="openvolume != null" >
        OPENVOLUME,
      </if>
      <if test="closevolume != null" >
        CLOSEVOLUME,
      </if>
      <if test="openamount != null" >
        OPENAMOUNT,
      </if>
      <if test="closeamount != null" >
        CLOSEAMOUNT,
      </if>
      <if test="positioncost != null" >
        POSITIONCOST,
      </if>
      <if test="premargin != null" >
        PREMARGIN,
      </if>
      <if test="usemargin != null" >
        USEMARGIN,
      </if>
      <if test="frozenmargin != null" >
        FROZENMARGIN,
      </if>
      <if test="frozencash != null" >
        FROZENCASH,
      </if>
      <if test="frozencommission != null" >
        FROZENCOMMISSION,
      </if>
      <if test="cashin != null" >
        CASHIN,
      </if>
      <if test="commission != null" >
        COMMISSION,
      </if>
      <if test="closeprofit != null" >
        CLOSEPROFIT,
      </if>
      <if test="positionprofit != null" >
        POSITIONPROFIT,
      </if>
      <if test="presettlementprice != null" >
        PRESETTLEMENTPRICE,
      </if>
      <if test="settlementprice != null" >
        SETTLEMENTPRICE,
      </if>
      <if test="tradingday != null" >
        TRADINGDAY,
      </if>
      <if test="settlementid != null" >
        SETTLEMENTID,
      </if>
      <if test="opencost != null" >
        OPENCOST,
      </if>
      <if test="exchangemargin != null" >
        EXCHANGEMARGIN,
      </if>
      <if test="combposition != null" >
        COMBPOSITION,
      </if>
      <if test="comblongfrozen != null" >
        COMBLONGFROZEN,
      </if>
      <if test="combshortfrozen != null" >
        COMBSHORTFROZEN,
      </if>
      <if test="closeprofitbydate != null" >
        CLOSEPROFITBYDATE,
      </if>
      <if test="closeprofitbytrade != null" >
        CLOSEPROFITBYTRADE,
      </if>
      <if test="todayposition != null" >
        TODAYPOSITION,
      </if>
      <if test="marginratebymoney != null" >
        MARGINRATEBYMONEY,
      </if>
      <if test="marginratebyvolume != null" >
        MARGINRATEBYVOLUME,
      </if>
      <if test="subuserid != null" >
        SUBUSERID,
      </if>
      <if test="frontid != null" >
        FRONTID,
      </if>
      <if test="sessionid != null" >
        SESSIONID,
      </if>
      <if test="orderref != null" >
        ORDERREF,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="instrumentid != null" >
        #{instrumentid,jdbcType=VARCHAR},
      </if>
      <if test="brokerid != null" >
        #{brokerid,jdbcType=VARCHAR},
      </if>
      <if test="investorid != null" >
        #{investorid,jdbcType=VARCHAR},
      </if>
      <if test="posidirection != null" >
        #{posidirection,jdbcType=VARCHAR},
      </if>
      <if test="hedgeflag != null" >
        #{hedgeflag,jdbcType=VARCHAR},
      </if>
      <if test="positiondate != null" >
        #{positiondate,jdbcType=VARCHAR},
      </if>
      <if test="ydposition != null" >
        #{ydposition,jdbcType=DECIMAL},
      </if>
      <if test="position != null" >
        #{position,jdbcType=DECIMAL},
      </if>
      <if test="longfrozen != null" >
        #{longfrozen,jdbcType=DECIMAL},
      </if>
      <if test="shortfrozen != null" >
        #{shortfrozen,jdbcType=DECIMAL},
      </if>
      <if test="longfrozenamount != null" >
        #{longfrozenamount,jdbcType=DECIMAL},
      </if>
      <if test="shortfrozenamount != null" >
        #{shortfrozenamount,jdbcType=DECIMAL},
      </if>
      <if test="openvolume != null" >
        #{openvolume,jdbcType=DECIMAL},
      </if>
      <if test="closevolume != null" >
        #{closevolume,jdbcType=DECIMAL},
      </if>
      <if test="openamount != null" >
        #{openamount,jdbcType=DECIMAL},
      </if>
      <if test="closeamount != null" >
        #{closeamount,jdbcType=DECIMAL},
      </if>
      <if test="positioncost != null" >
        #{positioncost,jdbcType=DECIMAL},
      </if>
      <if test="premargin != null" >
        #{premargin,jdbcType=DECIMAL},
      </if>
      <if test="usemargin != null" >
        #{usemargin,jdbcType=DECIMAL},
      </if>
      <if test="frozenmargin != null" >
        #{frozenmargin,jdbcType=DECIMAL},
      </if>
      <if test="frozencash != null" >
        #{frozencash,jdbcType=DECIMAL},
      </if>
      <if test="frozencommission != null" >
        #{frozencommission,jdbcType=DECIMAL},
      </if>
      <if test="cashin != null" >
        #{cashin,jdbcType=DECIMAL},
      </if>
      <if test="commission != null" >
        #{commission,jdbcType=DECIMAL},
      </if>
      <if test="closeprofit != null" >
        #{closeprofit,jdbcType=DECIMAL},
      </if>
      <if test="positionprofit != null" >
        #{positionprofit,jdbcType=DECIMAL},
      </if>
      <if test="presettlementprice != null" >
        #{presettlementprice,jdbcType=DECIMAL},
      </if>
      <if test="settlementprice != null" >
        #{settlementprice,jdbcType=DECIMAL},
      </if>
      <if test="tradingday != null" >
        #{tradingday,jdbcType=VARCHAR},
      </if>
      <if test="settlementid != null" >
        #{settlementid,jdbcType=DECIMAL},
      </if>
      <if test="opencost != null" >
        #{opencost,jdbcType=DECIMAL},
      </if>
      <if test="exchangemargin != null" >
        #{exchangemargin,jdbcType=DECIMAL},
      </if>
      <if test="combposition != null" >
        #{combposition,jdbcType=DECIMAL},
      </if>
      <if test="comblongfrozen != null" >
        #{comblongfrozen,jdbcType=DECIMAL},
      </if>
      <if test="combshortfrozen != null" >
        #{combshortfrozen,jdbcType=DECIMAL},
      </if>
      <if test="closeprofitbydate != null" >
        #{closeprofitbydate,jdbcType=DECIMAL},
      </if>
      <if test="closeprofitbytrade != null" >
        #{closeprofitbytrade,jdbcType=DECIMAL},
      </if>
      <if test="todayposition != null" >
        #{todayposition,jdbcType=DECIMAL},
      </if>
      <if test="marginratebymoney != null" >
        #{marginratebymoney,jdbcType=DECIMAL},
      </if>
      <if test="marginratebyvolume != null" >
        #{marginratebyvolume,jdbcType=DECIMAL},
      </if>
      <if test="subuserid != null" >
        #{subuserid,jdbcType=VARCHAR},
      </if>
      <if test="frontid != null" >
        #{frontid,jdbcType=DECIMAL},
      </if>
      <if test="sessionid != null" >
        #{sessionid,jdbcType=DECIMAL},
      </if>
      <if test="orderref != null" >
        #{orderref,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  <update id="subTractionPosition" parameterType="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    update T_INVESTOR_POSITION set CLOSEAMOUNT = #{closeamount,jdbcType=DECIMAL}
    ,CLOSEVOLUME = #{closevolume,jdbcType=DECIMAL}
    where SUBUSERID = #{subuserid,jdbcType=VARCHAR} 
    and INSTRUMENTID = #{instrumentid,jdbcType=VARCHAR} 
    and FRONTID = #{frontid,jdbcType=DECIMAL} 
    and SESSIONID = #{sessionid,jdbcType=DECIMAL} 
    and ORDERREF = #{orderref,jdbcType=VARCHAR} 
  </update>
  
  <select id="getUserByOpenPosition" resultMap="BaseResultMap" parameterType="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    select * from T_INVESTOR_POSITION
    where INSTRUMENTID = #{instrumentid,jdbcType=VARCHAR} 
    and POSIDIRECTION = #{posidirection,jdbcType=VARCHAR} 
    and SUBUSERID = #{subuserid,jdbcType=VARCHAR} 
    and POSITION > 0
  </select>
  
  <update id="updateOpenPosition" parameterType="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    update T_INVESTOR_POSITION set OPENVOLUME = #{openvolume,jdbcType=DECIMAL}
    ,OPENAMOUNT = #{openamount,jdbcType=DECIMAL}
    ,POSITION = #{position,jdbcType=DECIMAL}
    ,COMMISSION = #{commission,jdbcType=DECIMAL},OPENTIME = to_char(sysdate,'yyyymmddhh24miss')
    where SUBUSERID = #{subuserid,jdbcType=VARCHAR} 
    and INSTRUMENTID = #{instrumentid,jdbcType=VARCHAR} 
    and POSIDIRECTION = #{posidirection,jdbcType=VARCHAR} 
    and POSITION > 0
  </update>
  
  <update id="updateClosePosition" parameterType="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    update T_INVESTOR_POSITION set CLOSEAMOUNT = #{closeamount,jdbcType=DECIMAL}
    ,CLOSEVOLUME = #{closevolume,jdbcType=DECIMAL}
    ,POSITION = #{position,jdbcType=DECIMAL}
    ,COMMISSION = #{commission,jdbcType=DECIMAL},OPENTIME = to_char(sysdate,'yyyymmddhh24miss')
    where SUBUSERID = #{subuserid,jdbcType=VARCHAR} 
    and INSTRUMENTID = #{instrumentid,jdbcType=VARCHAR} 
    and POSIDIRECTION = #{posidirection,jdbcType=VARCHAR} 
    and POSITION > 0
  </update>
  
  <update id="updateUserOpenAmount" parameterType="com.bohai.subAccount.entity.InvestorPosition" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    update T_INVESTOR_POSITION set OPENAMOUNT = #{openamount,jdbcType=DECIMAL} 
    where SUBUSERID = #{subuserid,jdbcType=VARCHAR} 
    and INSTRUMENTID = #{instrumentid,jdbcType=VARCHAR} 
    and POSIDIRECTION = #{posidirection,jdbcType=VARCHAR}
  </update>
  
  <select id="getSubUserPostion" resultMap="BaseResultMap" parameterType="java.lang.String"  >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    select * from T_INVESTOR_POSITION
    where  SUBUSERID = #{subuserid,jdbcType=VARCHAR} 
    and POSITION > 0
  </select>
  
  <select id="getSubUserPostion2" resultMap="BaseResultMap" parameterType="java.lang.String"  >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jan 18 12:54:24 CST 2017.
    -->
    select * from T_INVESTOR_POSITION
    where  SUBUSERID = #{0,jdbcType=VARCHAR} 
    and INSTRUMENTID = #{1,jdbcType=VARCHAR}
    and POSIDIRECTION = #{2,jdbcType=VARCHAR}
    and POSITION > 0
  </select>
  
  <select id="getUserClosePostion" resultMap="BaseResultMap" parameterType="java.lang.String">
    select * from T_INVESTOR_POSITION
    where  SUBUSERID = #{subuserid,jdbcType=VARCHAR} 
    and POSITION = 0
    order by opentime asc
  </select>
  
</mapper>